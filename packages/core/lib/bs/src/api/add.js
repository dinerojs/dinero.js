// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Stdlib_Option from "@rescript/runtime/lib/es6/Stdlib_Option.js";
import * as NormalizeScale from "./normalizeScale.js";
import * as Stdlib_JsError from "@rescript/runtime/lib/es6/Stdlib_JsError.js";
import * as HaveSameCurrency from "./haveSameCurrency.js";
import * as Primitive_option from "@rescript/runtime/lib/es6/Primitive_option.js";

function unsafeAdd(calculator) {
  return (augend, addend) => {
    let match = augend.toJSON();
    let match$1 = addend.toJSON();
    let amount = calculator.add(match.amount, match$1.amount);
    return augend.create({
      amount: amount,
      currency: match.currency,
      scale: Primitive_option.some(match.scale)
    });
  };
}

function safeAdd(calculator) {
  let normalizeFn = NormalizeScale.normalizeScale(calculator);
  let addFn = unsafeAdd(calculator);
  return (augend, addend) => {
    let condition = HaveSameCurrency.haveSameCurrency([
      augend,
      addend
    ]);
    if (!condition) {
      Stdlib_JsError.throwWithMessage("Objects must have the same currency.");
    }
    let normalized = normalizeFn([
      augend,
      addend
    ]);
    let newAugend = Stdlib_Option.getOrThrow(normalized[0], undefined);
    let newAddend = Stdlib_Option.getOrThrow(normalized[1], undefined);
    return addFn(newAugend, newAddend);
  };
}

export {
  unsafeAdd,
  safeAdd,
}
/* No side effect */
